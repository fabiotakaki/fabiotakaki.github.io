<!DOCTYPE html>
<html><meta charset="utf-8">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
<link href="https://fonts.googleapis.com/css?family=Open+Sans|Teko" rel="stylesheet">
<link href="/css/style.css" rel="stylesheet" />
<title>
  
  Fabio S. Takaki - TakakiME
  
</title><body>
      <div class="container">
        <div class="wrapper"><header>
  <a href="/">
    <img src="/img/profile.png" class="profile" />
  </a>
  <h1><a href="/">Fabio S. Takaki</a></h1>  
  <div class="social-media">
    <a href="https://www.linkedin.com/in/fabiotakaki" target="_blank"><i class="fab fa-linkedin"></i></a>
    <a href="https://www.github.com/takaki10" target="_blank"><i class="fab fa-github-square"></i></a>
    <a href="https://www.twitter.com/fabiotakaki" target="_blank"><i class="fab fa-twitter-square"></i></a>
    <a href="mailto:fabio.stakaki@gmail.com" target="_blank"><i class="fas fa-envelope-square"></i></a>
  </div>
  <a href="https://drive.google.com/file/d/0B-PL2BKr22AveWpBMGpka21uQlk/view?usp=sharing" target="_blank">Download my CV <i class="fas fa-paperclip"></i></a>
</header>
<div id="content">
<section id="main">
  <div class="title">
    <h1 id="title">Deploy Django Project in CentOS 7.2</h1>
    <h4 id="date"> Mon Apr 4, 2016 </h4>
    <h5 id="wordcount"> 477 Words </h5>
  </div>
  <div>
      <article id="content" class="post-body">
         <p>Today We will deploy my first project created with Django Framework 1.9 in CentOS 7.2. To do that, first I created a droplet with CentOS 7.2 installed. If you don&rsquo;t know how to create a droplet in Digital Ocean, see this <a href="https://www.digitalocean.com/community/tutorials/how-to-create-your-first-digitalocean-droplet-virtual-server" target="_blank">tutorial</a>. Lastly, to deploy the project, we will use Apache with mod_wsgi.</p>

<p>Now, let&rsquo;s start:</p>

<ul>
<li><p>First update repositories:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">yum update -y</code></pre></div></p></li>

<li><p>To get <code>pip</code>, we&rsquo;ll need to enable the EPEL repository, which as some additional packages. You can do that easily by typing:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo yum install epel-release</code></pre></div></p></li>

<li><p>With EPEL enabled, we can install the components we need by typing:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo yum install python-pip httpd mod_wsgi </code></pre></div></p></li>

<li><p>Now, we will install Mysql for database project. So, let&rsquo;s download and install MySQL repository:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">wget http://repo.mysql.com/mysql-community-release-el7-5.noarch.rpm
sudo rpm -ivh mysql-community-release-el7-5.noarch.rpm
yum update</code></pre></div></p></li>

<li><p>After repositories is OK, let&rsquo;s install MySQL Server and Start it !
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">yum install mysql-server
systemctl start mysqld</code></pre></div></p></li>

<li><p>With MySQL installed, we will configure using following command:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mysql_secure_installation</code></pre></div></p></li>

<li><p>Follow steps configuration. Before we download the project from git, let&rsquo;s add user and put the project in user&rsquo;s folder. In this way, you can add others projects in others users, using one server. Substitute <username> in any user:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">useradd &lt;username&gt;
passwd &lt;username&gt;</code></pre></div></p></li>

<li><p>After added user, let&rsquo;s install git and download django project in user folder:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">yum install git -y
cd /home/&lt;username&gt;
git clone &lt;URL-Repository&gt;</code></pre></div></p></li>

<li><p>Using git clone, you will download all files project into your user&rsquo;s folder. Now, we use <code>virtualenv</code> and <code>virtualenvwrapper</code> to manage each project virtual enviroment. So let&rsquo;s install using <code>virtualenvwrapper</code>, because it will install <code>virtualenv</code> automatically:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pip install virtualenvwrapper</code></pre></div></p></li>

<li><p>To bash CentOS recognize <code>virtualenvwrapper</code> commands, let&rsquo;s add 3 lines at ~/.bash_profile, so use command <code>nano ~/.bash_profile</code> and add this content:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">export WORKON_HOME<span style="color:#f92672">=</span>$HOME/.virtualenvs
export PROJECT_HOME<span style="color:#f92672">=</span>$HOME/Devel
source /usr/bin/virtualenvwrapper.sh</code></pre></div></p></li>

<li><p>After that, we will create our virtualenv and install all requeriments of your project in txt:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkvirtualenv &lt;nameproject&gt;
yum install gcc python-devel mysql-devel libevent-devel
pip install -r requeriments.txt</code></pre></div></p></li>

<li><p>Let&rsquo;s now create database for your project and import structure by Django migrations:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mysql -u root -p&lt;PASSWORD&gt;
	create database &lt;databasename&gt;;
	exit;

python manage.py migrate</code></pre></div></p></li>

<li><p>Create a superuser Administration:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python manage.py createsuperuser</code></pre></div></p></li>

<li><p>Now, we will collect static files, but you should certificate your <code>settings.py</code> STATIC_FILES is configured correctly:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python manage.py collectstatic</code></pre></div></p></li>

<li><p>So, all it&rsquo;s ok ! We just need to configure <code>Apache</code> with <code>mod_wsgi</code>. To do that, we will create a file configuration at <code>/etc/httpd/conf.d/</code> with any name:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">nano /etc/httpd/conf.d/django.conf</code></pre></div></p></li>

<li><p>And put this content, replacing variables &lt;&gt; with your username or nameproject. The <envproject> is the name of VirtualEnv you created to your project.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">&lt;VirtualHost *:80&gt;
    ServerName www.mydomain.com
    DocumentRoot /home/&lt;username&gt;/&lt;nameproject&gt;

    Alias /static /home/&lt;username&gt;/&lt;nameproject&gt;/static
    &lt;Directory /home/&lt;username&gt;/&lt;nameproject&gt;/static&gt;
        Require all granted
    &lt;/Directory&gt;

    &lt;Directory /home/&lt;username&gt;/&lt;nameproject&gt;/&lt;nameproject&gt;&gt;
        &lt;Files wsgi.py&gt;
            Require all granted
        &lt;/Files&gt;
    &lt;/Directory&gt;

    WSGIDaemonProcess &lt;nameproject&gt; python-path<span style="color:#f92672">=</span>/home/&lt;username&gt;/&lt;nameproject&gt;:/&lt;username&gt;/.envs/&lt;envproject&gt;/lib/python2.7/site-packages
    WSGIProcessGroup &lt;nameproject&gt;
    WSGIScriptAlias / /home/&lt;username&gt;/&lt;nameproject&gt;/&lt;nameproject&gt;/wsgi.py

&lt;/VirtualHost&gt;</code></pre></div></p></li>

<li><p>Now we will put some permissions and we finish !
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">chmod <span style="color:#ae81ff">664</span> /home/&lt;username&gt;/&lt;nameproject&gt;
sudo chown :www-data /home/&lt;username&gt;/&lt;nameproject&gt;</code></pre></div></p></li>

<li><p>To finish, we restart Apache !
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo service apache2 restart</code></pre></div></p></li>
</ul>

      </article>
  </div>
</section>
<aside id="meta">
    <div>
    <h4>Categories</h4>
    
    <ul id="categories">
      
        <li><a href="/categoriesarticles">Articles</a> </li>
      
    </ul>
    
    
    </div>
    <div class="nav-bottom">
        
          <a class="previous" href="/posts/2016-03-11-software-engineer/">Previous: Software Engineer</a>
        
        
          <a class="next" href="/posts/2016-11-08-rgb-and-hsl/">Next: RGB and HSL</a>
        
    </div>
</aside>

          </div><footer>
  <p>Copyright &copy; 2018 - takaki.me</p>
</footer></div>
      </div>
    </body>
</html>
